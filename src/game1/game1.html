<!DOCTYPE html>
<html lang="uk">

<head>
    <title>Game 1</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="game1.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500&family=Unica+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Play&display=swap" rel="stylesheet">
</head>

<body>

<div id="top">
    <div id="logo">LingvoLab</div>
    <span id="page"></span>
</div>

<div id="middle">
    <div class="wrapper">
        <div class="card">

            <div class="front">
                <span id="word"></span>
            </div>
            <div class=”back”>
                <span id="meaning"></span>
            </div>
        </div>
    </div>
    <div id="buttons">
        <div class="next1" id="button1">got it</div>
        <img id="audioImage" src="../Images/tools/audio.png"/>
        <div class="next2" id="button2">study again</div>
    </div>
</div>

<div id="bottom">
    <div><img id="backImage" title="back to main page" onclick="document.location='../introPages/main page/main.html'" src="../Images/tools/back.png"/></div>
</div>

<!--<script src ="game1.js"></script>-->

<script type="module">
    import User from '../User.js';

    //array with words
    const words = ["adult", "answer", "ball", "bathroom", "camera"];

    const meaning = ["a person or animal that has grown to full size and strength",
        "what you say or write back to someone who has asked you a question or spoken to you",
        "a round object that you throw, kick, or hit in a game, or something with this shape",
        "a room with a bath and/or shower and often a toilet",
        "a device for taking photographs or making films or television programmes"];


    //array with sounds
    const sounds = ['../Music/game1/A1/Adult.mp3','../Music/game1/A1/Answer.mp3','../Music/game1/A1/Ball.mp3','../Music/game1/A1/Bathroom.mp3','../Music/game1/A1/Camera.mp3']

    //get name of current user
    const name = localStorage.getItem("last");

    const currentUser = User.build(localStorage.getItem(name));

    //set first world
    firstWord();

    function firstWord(){
        if(currentUser.getProgressGame1()[0].length<1) {
            currentUser.setProgressGame1(words);
            localStorage.setItem(name,currentUser.toString());
        }
    }



    let progress = currentUser.getProgressGame1();
    document.getElementById("word").textContent = progress[0];
    document.getElementById("meaning").textContent = meaning[0];
    document.getElementById("page").textContent = ((words.indexOf(document.getElementById("word").textContent.toString())+1) + "/" + words.length).toString();

    localStorage.setItem(name,currentUser.toString());

    //add event listener
    document.getElementById('button1').addEventListener("click",gotIt);
    document.getElementById('button2').addEventListener("click",studyAgain);
    document.getElementById('audioImage').addEventListener("click",sound);

    function gotIt(){
        let index = progress.indexOf(document.getElementById("word").textContent.toString());

        if(index>-1){
            let newArray = [];
            for (let i = 0; i < progress.length; i++) {
                if(i!==index){
                    newArray.push(progress[i]);
                }
            }
            progress = [];
            progress = newArray;
        }

        document.getElementById("word").textContent = progress[++index];
        document.getElementById("meaning").textContent = meaning[index];
        document.getElementById("page").textContent = ((words.indexOf(document.getElementById("word").textContent.toString())+1) + "/" + words.length).toString();
        currentUser.setProgressGame1(progress);
        localStorage.setItem(name,currentUser.toString());

        if((words.indexOf(document.getElementById("word").textContent)) <= +0) {
            // document.location.replace("../result/result.html");
        }
    }
    function studyAgain(){
        let index = progress.indexOf(document.getElementById("word").textContent.toString());
        if(index<progress.length) {
            document.getElementById("word").textContent = progress[++index];
            document.getElementById("meaning").textContent = meaning[index];
            document.getElementById("page").textContent = ((words.indexOf(document.getElementById("word").textContent.toString())+1) + "/" + words.length).toString();

        }
    }
    /* ===*/
    function sound() {
        var audio = new Audio(); // Создаём новый элемент Audio

        const currentWord = document.getElementById("word").textContent.toString();
        const index = words.indexOf(currentWord);

        audio.src = sounds[index]; // Указываем путь к звуку "клика"
        audio.autoplay = true; // Автоматически запускаем
    }

</script>

</body>

</html>