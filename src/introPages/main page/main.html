<!--
@file: main.html
@authors: Huza Mariia-Valeriia, Andriienko Yelyzaveta, Shevchenko Daria

A file of a main page of a user
-->
<!DOCTYPE html>
<html lang="uk">

 <head>
  <title>Main</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="main.css">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500&family=Unica+One&display=swap" rel="stylesheet">
 </head>
 
 <body>

  <div id="top">
    <div id="logo">LingvoLab</div>
    <div id="button" onclick="document.location='../instruction/instruction.html'">
      <img alt="settings" id="settings" onclick="document.location='../third/third.html'" src="../../Images/tools/settings.png"/>
    </div>
  </div>

  <div id="middle1">
    <span id="name"></span>
  </div>
  <div id="middle2">
    <span id="level"></span>
  </div>

  <div id="cardsRow1">
    <button class="floating-button" id="game1" onclick="document.location='../../game1/game1.html'">Quizlet</button>
    <button class="floating-button" id="game2" onclick="document.location='../../game2/game2.html'">game 2</button>
  </div>

  <div id="middle"></div>

  <div id="cardsRow2">
    <button class="floating-button" id="game3" onclick="document.location='../../game3/game3.html'">game 3</button>
    <button class="floating-button" id="game4" onclick="document.location='../../game4/game4.html'">game 4</button>
  </div>

  <script type="module">
      import User from '../../User.js';

      //set name
      let userName = localStorage.getItem("last");
      document.getElementById('name').textContent = userName.toString();
      let currentUser = User.build(localStorage.getItem(userName));

      document.getElementById("level").textContent = currentUser.getLevel().toString();
      console.log(currentUser.toString());
      console.log(currentUser.getLevel());

      checkLevel();

      function checkLevel(){

          if (currentUser.getProgressGame1().length===0 && currentUser.getProgressGame2().length===0 &&
              currentUser.getProgressGame3().length===0 && currentUser.getProgressGame4().length===0 ){

              currentUser.setIndexAtGame2(0);
              currentUser.setIndexAtGame3(0);
              currentUser.setIndexAtGame4(0);

              currentUser.setProgressGame1([""]);
              currentUser.setProgressGame2([""]);
              currentUser.setProgressGame3([""]);
              currentUser.setProgressGame4([""]);

              if(currentUser.getLevel()==="A1"){
                  currentUser.setLevel("A2");
                  document.getElementById("level").textContent = currentUser.getLevel();
                  showMassage();

              }
              else if(currentUser.getLevel()==="A2"){
                  currentUser.setLevel("B1");
                  document.getElementById("level").textContent = "Ваш рівень знань англійської мови підвисився! Тепер у вас " + currentUser.getLevel() + " . Вітаємо!";
                  showMassage();

              }
              else if(currentUser.getLevel()==="B1"){
                  currentUser.setLevel("B2");
                  document.getElementById("level").textContent = "Ваш рівень знань англійської мови підвисився! Тепер у вас " + currentUser.getLevel() + " . Вітаємо!";
                  showMassage();

              }
              else if(currentUser.getLevel()==="B2"){
                  currentUser.setLevel("C1");
                  document.getElementById("level").textContent = "Ваш рівень знань англійської мови підвисився! Тепер у вас " + currentUser.getLevel() + " . Вітаємо!";
                  showMassage();

              }

              else {

                  document.getElementById("level").textContent = "Ви дійшли до максимального рівня! Вітаємо :) ";

              }

              localStorage.setItem(userName,currentUser.toString());

          }


      }

      function showMassage(){

          document.getElementById("game1").remove();
          document.getElementById("game2").remove();
          document.getElementById("game3").remove();
          document.getElementById("game4").remove();

          let newBox = document.createElement("div");
          newBox.id = "newBox";

          let newText = document.createElement("p");
          newText.id = "newText";
          newText.textContent = "Ваш рівень знань англійської мови підвисився! Тепер у вас " + currentUser.getLevel() + " . Вітаємо!";

          newBox.appendChild(newText);

          let newButton = document.createElement("div");
          newButton.addEventListener("click",window.location.reload())
          newButton.onClick = "window.location.reload()";
          newButton.id = "mainPage";
          newButton.style =
              "    margin: 7.5px 0px 7.5px 0px;\n" +
              "z-index: 5;\n" +
              "    min-height: 55px;\n" +
              "    min-width: 55px;";
          newButton.href = "main.html";
          let newArrow = document.createElement("img");
          newArrow.src="../../Images/tools/next.png";
          newArrow.title="go to the main page";
          newArrow.style = "    height: 8.9vh;\n" +
              "z-index: 5;\n" +
              "    width: 4.5vw;\n" ;
          newButton.appendChild(newArrow);

          newBox.appendChild(newButton);

          document.getElementById("middle").appendChild(newBox);

      }

      function returnEverything(){
          document.getElementById("newBox").remove();

          document.getElementById("game1").show();
          document.getElementById("game2").show();
          document.getElementById("game3").show();
          document.getElementById("game4").show();

      }

  </script>


 </body>
</html>